<!DOCTYPE html>
<html lang="english">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>DarthDanAmesh - Linux</title>
        <link rel="stylesheet" href="https://darthdanamesh.github.io/theme/css/main.css" />
        <link href="https://darthdanamesh.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="DarthDanAmesh Atom Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://darthdanamesh.github.io/">DarthDanAmesh</a></h1>
                <nav><ul>
                    <li><a href="https://darthdanamesh.github.io/pages/about.html">About</a></li>
                    <li><a href="https://darthdanamesh.github.io/category/guides.html">Guides</a></li>
                    <li><a href="https://darthdanamesh.github.io/category/tutorial.html">Tutorial</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="https://darthdanamesh.github.io/installing-docker-for-parrot-os.html">Installing Docker for Parrot OS</a></h1>
<footer class="post-info">
        <abbr class="published" title="2022-05-06T00:00:00+02:00">
                Published: Fri 06 May 2022
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://darthdanamesh.github.io/author/darthdanamesh.html">DarthDanAmesh</a>
        </address>
<p>In <a href="https://darthdanamesh.github.io/category/guides.html">Guides</a>.</p>
<p>tags: <a href="https://darthdanamesh.github.io/tag/docker.html">Docker</a> <a href="https://darthdanamesh.github.io/tag/linux.html">Linux</a> </p>
</footer><!-- /.post-info --><h3>Terminal Commands</h3>
<p>Open your terminal and type the following commands :</p>
<div class="highlight"><pre><span></span><code><span class="nv">$sudo</span><span class="w"> </span>apt<span class="w"> </span>update
</code></pre></div>

<h3>Install docker dependencies</h3>
<div class="highlight"><pre><span></span><code><span class="nv">$sudo</span><span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>apt-transport-https<span class="w"> </span>ca-certificates<span class="w"> </span>curl<span class="w"> </span>gnupg<span class="w"> </span>lsb-release<span class="w"> </span>-y
</code></pre></div>

<h3>Get the docker PGP key</h3>
<div class="highlight"><pre><span></span><code><span class="nv">$curl</span><span class="w"> </span>-fsSL<span class="w"> </span>https://download.docker.com/linux/debian/gpg<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span>-o<span class="w"> </span>/usr/share/keyrings/docker-archive-keyring.gpg
</code></pre></div>

<p>In the command below be sure to replace with whatever version of debian you are running, i.e., buster, bullseye, stretch</p>
<div class="highlight"><pre><span></span><code><span class="nv">$echo</span><span class="w"> </span><span class="s2">&quot;deb [arch=</span><span class="k">$(</span>dpkg<span class="w"> </span>--print-architecture<span class="k">)</span><span class="s2"> signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/debian buster stable&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/docker.list<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
</code></pre></div>

<p>Perform an update for installed binaries. </p>
<div class="highlight"><pre><span></span><code><span class="nv">$sudo</span><span class="w"> </span>apt<span class="w"> </span>update
<span class="nv">$sudo</span><span class="w"> </span>apt<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>docker-ce<span class="w"> </span>docker-ce-cli<span class="w"> </span>containerd.io
</code></pre></div>

<h3>Add Username to Docker Group</h3>
<p>Sometimes you do not want to use docker with sudo account. You can add another username to docker group so that sudo command is not necessary for the docker user</p>
<div class="highlight"><pre><span></span><code><span class="nv">$sudo</span><span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>docker<span class="w"> </span>your_username
</code></pre></div>

<p>That's it. You should be able to run docker commands in your system. </p>
<h2>Docker</h2>
<p>This part was first created Monday, March 7, 2022. From my Securanalyst.blogspot.com</p>
<div class="highlight"><pre><span></span><code><span class="nv">$docker</span><span class="w"> </span>images
<span class="nv">$docker</span><span class="w"> </span>search<span class="w"> </span><span class="o">[</span>image<span class="o">]</span>
</code></pre></div>

<h3>Downloading an image</h3>
<div class="highlight"><pre><span></span><code><span class="nv">$docker</span><span class="w"> </span>pull<span class="w"> </span><span class="o">[</span>image<span class="o">]</span>

//<span class="w"> </span>example<span class="w"> </span>install<span class="w"> </span>an<span class="w"> </span>ubuntu<span class="w"> </span>image
<span class="nv">$docker</span><span class="w"> </span>pull<span class="w"> </span>ubuntu

Alternatively

<span class="nv">$docker</span><span class="w"> </span>run<span class="w"> </span><span class="o">[</span>image<span class="o">]</span>
//<span class="w"> </span>run<span class="w"> </span>the<span class="w"> </span>image
<span class="nv">$docker</span><span class="w"> </span>run<span class="w"> </span>ubuntu
</code></pre></div>

<h3>Useful information about containers</h3>
<p>To get a list of all running containers</p>
<div class="highlight"><pre><span></span><code><span class="nv">$docker</span><span class="w"> </span>ps
</code></pre></div>

<p>This will exit, because it is not set to run in the background capabilities. To make this run in the background run</p>
<div class="highlight"><pre><span></span><code><span class="nv">$docker</span><span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>-d<span class="w"> </span>ubuntu
//<span class="w"> </span>where<span class="w"> </span>the<span class="w"> </span>flag<span class="w"> </span>-it<span class="w"> </span>stands<span class="w"> </span><span class="k">for</span><span class="w"> </span>interactive<span class="w"> </span>terminal
//<span class="w"> </span>where<span class="w"> </span>the<span class="w"> </span>flag<span class="w"> </span>-d<span class="w"> </span>activates<span class="w"> </span>daemon<span class="w"> </span>/<span class="w"> </span>service<span class="w"> </span>mode
</code></pre></div>

<p>To get a list of all exited containers</p>
<div class="highlight"><pre><span></span><code><span class="nv">$docker</span><span class="w"> </span>ps<span class="w"> </span>-a
</code></pre></div>

<p>You can also type the first few unique characters of the id</p>
<div class="highlight"><pre><span></span><code><span class="nv">$docker</span><span class="w"> </span>attach<span class="w"> </span><span class="o">[</span>CONTAINER<span class="w"> </span>ID<span class="o">]</span>
</code></pre></div>

<h3>Image persistance</h3>
<p>To make this image persist press the key sequence below while not letting go off Cntrl key:</p>
<div class="highlight"><pre><span></span><code>Ctrl<span class="w"> </span>+<span class="w"> </span>p<span class="w"> </span>
Ctrl<span class="w"> </span>+<span class="w"> </span>q
</code></pre></div>

<p>Even when you exit (Ctrl+d), this container will persist.</p>
<h3>Run bash</h3>
<p>To run a bash or any other pre-inbuilt ubuntu command inside the ubuntu container image</p>
<div class="highlight"><pre><span></span><code><span class="nv">$docker</span><span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>ubuntu<span class="w"> </span>/bin/bash
</code></pre></div>

<p>This will open up a bash shell similar to ubuntu, with ubuntu capabilities quite similar to the wsl, which is absolutely awesome.</p>
<p>To exit, Ctrl + d</p>
<h2>Accessing Apps</h2>
<div class="highlight"><pre><span></span><code><span class="nv">$docker</span><span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>-d<span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>:80<span class="w"> </span>nginx
</code></pre></div>

<p>This ports are not accessible (by default) outside the container for security purposes. Access the nginx on localhost with the port on the browser to stop the process</p>
<div class="highlight"><pre><span></span><code><span class="nv">$docker</span><span class="w"> </span>stop<span class="w"> </span><span class="o">[</span>container_id<span class="o">]</span>
</code></pre></div>

<h3>Run web app</h3>
<p>To run web applications on container, that we want to run continuously.</p>
<div class="highlight"><pre><span></span><code><span class="nv">$docker</span><span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>-d<span class="w"> </span>--restart<span class="w"> </span>unless-stopped<span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>:80<span class="w"> </span>nginx
</code></pre></div>

<p>To remove a container:</p>
<div class="highlight"><pre><span></span><code><span class="nv">$docker</span><span class="w"> </span>rm<span class="w"> </span><span class="o">[</span>container_id<span class="o">]</span>
</code></pre></div>

<h3>Saving changes to image</h3>
<p>To save changes to image like ubuntu</p>
<div class="highlight"><pre><span></span><code><span class="nv">$docker</span><span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>ubuntu
<span class="nv">$apt</span><span class="w"> </span>udpate
<span class="nv">$apt</span><span class="w"> </span>dist-upgrade
<span class="nv">$apt</span><span class="w"> </span>install<span class="w"> </span>apache2
$/etc/init.d/apache2<span class="w"> </span>status
$/etc/init.d/apache2<span class="w"> </span>start
<span class="nv">$apt</span><span class="w"> </span>install<span class="w"> </span>vim-nox
</code></pre></div>

<h3>Commit changes</h3>
<p>Disconnect using: Ctrl + p Ctrl + q</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>docker<span class="w"> </span>commit<span class="w"> </span><span class="o">[</span>container_id<span class="o">]</span><span class="w"> </span><span class="o">[</span>preferred<span class="w"> </span>name<span class="w"> </span>of<span class="w"> </span>image:version<span class="w"> </span>number<span class="o">]</span>

//<span class="w"> </span>For<span class="w"> </span>example
<span class="nv">$docker</span><span class="w"> </span>commit<span class="w"> </span><span class="o">[</span>container-id<span class="o">]</span><span class="w"> </span>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>lltv/apache:1.0<span class="w"> </span>.
</code></pre></div>

<p>The period (.) at the end is to create the image in current directory</p>
<h2>Automate the process by creating a Dockerfile</h2>
<p>First, create and open file called "Dockerfile"</p>
<div class="highlight"><pre><span></span><code><span class="nv">$touch</span><span class="w"> </span>Dockerfile
<span class="nv">$nano</span><span class="w"> </span>Dockerfile
</code></pre></div>

<p>Then you can paste the following (Edit where necessary): </p>
<div class="highlight"><pre><span></span><code>FROM<span class="w"> </span>ubuntu
MAINTAINER<span class="w"> </span>your_username<span class="w"> </span>&lt;your_email@example.com&gt;

<span class="c1"># Skip prompts</span>
ARG<span class="w"> </span><span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive

<span class="c1"># Update packages</span>
RUN<span class="w"> </span>apt<span class="w"> </span>update<span class="p">;</span><span class="w"> </span>apt<span class="w"> </span>dist-upgrade<span class="w"> </span>-y

<span class="c1"># Install packages</span>
RUN<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>apache2<span class="w"> </span>vim-nox

<span class="c1"># Set entrypoint</span>
ENTRYPOINT<span class="w"> </span>apache2ctl<span class="w"> </span>-D<span class="w"> </span>FOREGROUND
</code></pre></div>

<p>Then save and exit nano. </p>
<p>The next command must be run from the same location that contains the Dockerfile</p>
<div class="highlight"><pre><span></span><code><span class="nv">$docker</span><span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>lltv/apache:1.1<span class="w"> </span>.

//<span class="w"> </span>Important!<span class="w"> </span>note<span class="w"> </span>the<span class="w"> </span>period<span class="w"> </span><span class="o">(</span>.<span class="o">)</span><span class="w"> </span>at<span class="w"> </span>the<span class="w"> </span>end
</code></pre></div>

<p>to remove an image</p>
<div class="highlight"><pre><span></span><code><span class="nv">$docker</span><span class="w"> </span>images
<span class="nv">$docker</span><span class="w"> </span>rmi<span class="w"> </span><span class="o">[</span>image<span class="w"> </span>id<span class="o">]</span>
</code></pre></div>

<p>If you encounter any error; refer to the container id and remove it using: </p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>rm<span class="w"> </span><span class="o">[</span>container_id<span class="o">]</span>
</code></pre></div>                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://darthdanamesh.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>